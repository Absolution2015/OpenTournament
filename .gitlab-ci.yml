variables:
  ROOT: 'C:/UE/Engine/Binaries'
  AUTOMATION_TOOL: '%ROOT%/DotNET/AutomationTool.exe'
  UNREAL_BUILD_TOOL: '%ROOT%/DotNET/UnrealBuildTool.exe'
  UNREAL_EDITOR: '%ROOT%/Win64/UE4Editor-Cmd.exe'
  PROJECT_NAME: 'OpenTournament'
  PROJECT_PATH: '%CI_PROJECT_DIR%/%PROJECT_NAME%.uproject'

stages:
  - assembly:fetch
  - assembly:generate
  - editor-development-win64
  - client-development-win64
  - client-development-linux
  - client-shipping-win64
  - client-shipping-linux
  - server-development-win64
  - server-development-linux
  - server-shipping-win64
  - server-shipping-linux

# assembly

assembly_fetch:
  stage: assembly:fetch
  script:
    - call C:\BuildScripts\StartBuild.bat

assembly_generate:
  stage: assembly:generate
  script:
    - call %UNREAL_BUILD_TOOL% %PROJECT_PATH% -ProjectFiles -Game -Progress

# editor-development-win64

source:
  stage: editor-development-win64
  only:
    - develop-vlad
  script:
    - call %AUTOMATION_TOOL% BuildTarget -Project=%PROJECT_PATH% -Target=%PROJECT_NAME%Editor -Configuration=Development -Platform=Win64 -NoTools

#content:
#  stage: editor-development-win64
#  only:
#    branch: [develop-vlad]
#    schedule: [cron * * * * *] 
#  script:

# client-development-win64

# client-development-linux

# client-shipping-win64

# client-shipping-linux

# server-development-win64

# server-development-linux

# server-shipping-win64

# server-shipping-linux